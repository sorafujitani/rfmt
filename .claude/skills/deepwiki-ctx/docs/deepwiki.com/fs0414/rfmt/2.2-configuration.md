---
title: "Configuration | fs0414/rfmt | DeepWiki"
source_url: "https://deepwiki.com/fs0414/rfmt/2.2-configuration"
fetched_at: "2026-01-13T10:53:43.101777+00:00"
---



Loading...

Index your code with Devin

[DeepWiki](https://deepwiki.com/)

[DeepWiki](https://deepwiki.com/)

[fs0414/rfmt](https://github.com/fs0414/rfmt "Open repository")

Index your code with

Devin

Edit WikiShare

Loading...

Last indexed: 3 January 2026 ([90c575](https://github.com/fs0414/rfmt/commits/90c575e6))

* [Overview](https://deepwiki.com/fs0414/rfmt/1-overview.html)
* [Architecture Overview](https://deepwiki.com/fs0414/rfmt/1.1-architecture-overview.html)
* [Key Concepts](https://deepwiki.com/fs0414/rfmt/1.2-key-concepts.html)
* [Getting Started](https://deepwiki.com/fs0414/rfmt/2-getting-started.html)
* [Installation](https://deepwiki.com/fs0414/rfmt/2.1-installation.html)
* [Configuration](https://deepwiki.com/fs0414/rfmt/2.2-configuration.html)
* [User Guides](https://deepwiki.com/fs0414/rfmt/3-user-guides.html)
* [CLI Usage](https://deepwiki.com/fs0414/rfmt/3.1-cli-usage.html)
* [Ruby API](https://deepwiki.com/fs0414/rfmt/3.2-ruby-api.html)
* [Editor Integration](https://deepwiki.com/fs0414/rfmt/3.3-editor-integration.html)
* [Core Systems](https://deepwiki.com/fs0414/rfmt/4-core-systems.html)
* [AST Representation](https://deepwiki.com/fs0414/rfmt/4.1-ast-representation.html)
* [Formatting Engine (Emitter)](https://deepwiki.com/fs0414/rfmt/4.2-formatting-engine-(emitter).html)
* [Parser Integration (PrismBridge)](https://deepwiki.com/fs0414/rfmt/4.3-parser-integration-(prismbridge).html)
* [Configuration System](https://deepwiki.com/fs0414/rfmt/4.4-configuration-system.html)
* [Caching System](https://deepwiki.com/fs0414/rfmt/4.5-caching-system.html)
* [Logging System](https://deepwiki.com/fs0414/rfmt/4.6-logging-system.html)
* [Formatting Behavior](https://deepwiki.com/fs0414/rfmt/5-formatting-behavior.html)
* [Control Flow Formatting](https://deepwiki.com/fs0414/rfmt/5.1-control-flow-formatting.html)
* [Exception Handling Formatting](https://deepwiki.com/fs0414/rfmt/5.2-exception-handling-formatting.html)
* [Lambda and Block Formatting](https://deepwiki.com/fs0414/rfmt/5.3-lambda-and-block-formatting.html)
* [Development](https://deepwiki.com/fs0414/rfmt/6-development.html)
* [Building from Source](https://deepwiki.com/fs0414/rfmt/6.1-building-from-source.html)
* [Testing](https://deepwiki.com/fs0414/rfmt/6.2-testing.html)
* [Release Process](https://deepwiki.com/fs0414/rfmt/6.3-release-process.html)
* [Reference](https://deepwiki.com/fs0414/rfmt/7-reference.html)
* [Node Types Reference](https://deepwiki.com/fs0414/rfmt/7.1-node-types-reference.html)
* [Configuration Options Reference](https://deepwiki.com/fs0414/rfmt/7.2-configuration-options-reference.html)
* [Error Codes Reference](https://deepwiki.com/fs0414/rfmt/7.3-error-codes-reference.html)
* [Performance and Benchmarks](https://deepwiki.com/fs0414/rfmt/7.4-performance-and-benchmarks.html)

Menu

# Configuration

Relevant source files

* [README.md](https://github.com/fs0414/rfmt/blob/90c575e6/README.md)
* [docs/user\_guide.ja.md](https://github.com/fs0414/rfmt/blob/90c575e6/docs/user_guide.ja.md)
* [docs/user\_guide.md](https://github.com/fs0414/rfmt/blob/90c575e6/docs/user_guide.md)
* [ext/rfmt/src/config/mod.rs](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/config/mod.rs)
* [ext/rfmt/src/logging/logger.rs](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/logging/logger.rs)
* [spec/config\_formatting\_spec.rb](https://github.com/fs0414/rfmt/blob/90c575e6/spec/config_formatting_spec.rb)

## Purpose and Scope

This document explains rfmt's configuration system, including configuration file discovery, structure, available options, and validation rules. Configuration controls formatting behavior (indentation, line length, quote style) and file selection (include/exclude patterns). For CLI-specific options like `--verbose` and `--diff`, see [CLI Usage](https://deepwiki.com/fs0414/rfmt/3.1-cli-usage.html). For the Ruby API to programmatically load configuration, see [Ruby API](https://deepwiki.com/fs0414/rfmt/3.2-ruby-api.html).

## Configuration File Discovery

rfmt searches for configuration files using a hierarchical discovery pattern, checking multiple locations in a specific order until a configuration file is found.

### Discovery Process

**Sources:** [ext/rfmt/src/config/mod.rs102-138](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/config/mod.rs#L102-L138) [README.md220-228](https://github.com/fs0414/rfmt/blob/90c575e6/README.md#L220-L228)

### Discovery Implementation

The configuration discovery is implemented in the Rust `Config::discover()` method:

| Step | Location Checked | File Names |
| --- | --- | --- |
| 1 | Current directory | `rfmt.yml`, `rfmt.yaml`, `.rfmt.yml`, `.rfmt.yaml` |
| 2 | Parent directories (walk up) | Same as above |
| 3 | Home directory | Same as above |
| 4 | Built-in defaults | `Config::default()` |

The discovery process stops at the first configuration file found. The `rfmt.yml` naming takes precedence over `.rfmt.yml` when both exist in the same directory.

**Sources:** [ext/rfmt/src/config/mod.rs102-138](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/config/mod.rs#L102-L138) [spec/config\_formatting\_spec.rb73-96](https://github.com/fs0414/rfmt/blob/90c575e6/spec/config_formatting_spec.rb#L73-L96)

### Ruby API for Configuration

The Ruby layer provides a simplified API for configuration management:

**Sources:** [README.md229-248](https://github.com/fs0414/rfmt/blob/90c575e6/README.md#L229-L248) [docs/user\_guide.md86-127](https://github.com/fs0414/rfmt/blob/90c575e6/docs/user_guide.md#L86-L127)

## Configuration Structure

rfmt's configuration is structured as nested sections mapping directly to Rust structs in the codebase.

### Configuration Schema to Code Mapping

**Sources:** [ext/rfmt/src/config/mod.rs3-99](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/config/mod.rs#L3-L99) [README.md121-143](https://github.com/fs0414/rfmt/blob/90c575e6/README.md#L121-L143)

### Complete Configuration Example

**Sources:** [README.md121-143](https://github.com/fs0414/rfmt/blob/90c575e6/README.md#L121-L143) [docs/user\_guide.md86-118](https://github.com/fs0414/rfmt/blob/90c575e6/docs/user_guide.md#L86-L118)

## Formatting Options

The `formatting` section controls code style rules. Each option maps to a field in the `FormattingConfig` struct.

### Core Formatting Options

| Option | Type | Default | Range/Values | Rust Field |
| --- | --- | --- | --- | --- |
| `line_length` | Integer | 100 | 40-500 | `FormattingConfig.line_length` |
| `indent_width` | Integer | 2 | 1-8 | `FormattingConfig.indent_width` |
| `indent_style` | String | "spaces" | "spaces", "tabs" | `FormattingConfig.indent_style` |
| `quote_style` | String | "double" | "double", "single", "consistent" | `FormattingConfig.quote_style` |

**Sources:** [ext/rfmt/src/config/mod.rs29-45](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/config/mod.rs#L29-L45) [docs/user\_guide.md131-173](https://github.com/fs0414/rfmt/blob/90c575e6/docs/user_guide.md#L131-L173)

### Option Details

#### `line_length`

Controls the maximum line length before wrapping. Validated to be between 40 and 500 characters.

**Validation:** [ext/rfmt/src/config/mod.rs162-169](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/config/mod.rs#L162-L169)

#### `indent_width`

Number of spaces (or tabs) per indentation level. Validated to be between 1 and 8.

**Validation:** [ext/rfmt/src/config/mod.rs171-178](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/config/mod.rs#L171-L178)

#### `indent_style`

Controls whether to use spaces or tabs for indentation. Maps to the `IndentStyle` enum.

**Enum Definition:** [ext/rfmt/src/config/mod.rs55-61](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/config/mod.rs#L55-L61)

#### `quote_style`

Preferred quote style for string literals. Maps to the `QuoteStyle` enum.

**Enum Definition:** [ext/rfmt/src/config/mod.rs75-82](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/config/mod.rs#L75-L82)

**Sources:** [ext/rfmt/src/config/mod.rs29-53](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/config/mod.rs#L29-L53) [docs/user\_guide.md131-173](https://github.com/fs0414/rfmt/blob/90c575e6/docs/user_guide.md#L131-L173)

### Style Sub-options

The `style` section within `formatting` provides additional style controls:

**Sources:** [ext/rfmt/src/config/mod.rs63-99](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/config/mod.rs#L63-L99)

## File Selection Patterns

The `include` and `exclude` sections control which files rfmt processes using glob patterns.

### Pattern Processing Flow

**Sources:** [ext/rfmt/src/config/mod.rs192-226](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/config/mod.rs#L192-L226)

### Default Patterns

| Section | Patterns | Purpose |
| --- | --- | --- |
| `include` | `**/*.rb`, `**/*.rake`, `**/Rakefile`, `**/Gemfile` | Ruby source files |
| `exclude` | `vendor/**/*`, `tmp/**/*`, `node_modules/**/*` | Vendored/temporary files |

**Default Implementation:** [ext/rfmt/src/config/mod.rs229-243](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/config/mod.rs#L229-L243)

### Pattern Precedence

Exclude patterns take precedence over include patterns. If a file matches any exclude pattern, it is skipped regardless of include patterns.

**Sources:** [ext/rfmt/src/config/mod.rs192-226](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/config/mod.rs#L192-L226) [README.md132-143](https://github.com/fs0414/rfmt/blob/90c575e6/README.md#L132-L143)

## Environment Variables

rfmt supports environment variables for runtime configuration, particularly for debugging and logging.

### Environment Variables to Code Mapping

**Sources:** [ext/rfmt/src/logging/logger.rs24-44](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/logging/logger.rs#L24-L44)

### Available Environment Variables

| Variable | Purpose | Values | Default |
| --- | --- | --- | --- |
| `DEBUG` | Enable debug mode | `1` or any value | Disabled |
| `RFMT_DEBUG` | Enable rfmt-specific debug | `1` or any value | Disabled |
| `RUST_LOG` | Rust logging (standard) | Any value | Disabled |
| `RFMT_LOG` | Control log level directly | `trace`, `debug`, `info`, `warn`, `error` | `warn` (normal), `info` (debug mode) |

### Usage Examples

**Sources:** [ext/rfmt/src/logging/logger.rs24-44](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/logging/logger.rs#L24-L44) [docs/user\_guide.md429-456](https://github.com/fs0414/rfmt/blob/90c575e6/docs/user_guide.md#L429-L456)

## Validation and Defaults

Configuration values are validated when loaded to ensure they are within acceptable ranges.

### Validation Rules

**Sources:** [ext/rfmt/src/config/mod.rs140-181](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/config/mod.rs#L140-L181)

### Validation Implementation

The validation logic is implemented in `Config::validate()`:

| Field | Validation Rule | Error Message |
| --- | --- | --- |
| `line_length` | 40 ≤ value ≤ 500 | "line\_length must be between 40 and 500, got {value}" |
| `indent_width` | 1 ≤ value ≤ 8 | "indent\_width must be between 1 and 8, got {value}" |

**Validation Code:** [ext/rfmt/src/config/mod.rs159-181](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/config/mod.rs#L159-L181)

### Default Values

If no configuration file is found or a value is not specified, rfmt uses these defaults:

**Default Implementation:** [ext/rfmt/src/config/mod.rs229-275](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/config/mod.rs#L229-L275)

### Partial Configuration

Configuration files can specify only a subset of options. Unspecified options use defaults:

This uses `line_length: 80` but retains default values for `indent_width: 2`, `indent_style: "spaces"`, etc.

**Sources:** [ext/rfmt/src/config/mod.rs229-275](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/config/mod.rs#L229-L275) [spec/config\_formatting\_spec.rb420-438](https://github.com/fs0414/rfmt/blob/90c575e6/spec/config_formatting_spec.rb#L420-L438)

Dismiss

Refresh this wiki

Enter email to refresh

### On this page

* [Configuration](https://deepwiki.com/fs0414/rfmt/2.2-configuration.html#configuration)
* [Purpose and Scope](https://deepwiki.com/fs0414/rfmt/2.2-configuration.html#purpose-and-scope)
* [Configuration File Discovery](https://deepwiki.com/fs0414/rfmt/2.2-configuration.html#configuration-file-discovery)
* [Discovery Process](https://deepwiki.com/fs0414/rfmt/2.2-configuration.html#discovery-process)
* [Discovery Implementation](https://deepwiki.com/fs0414/rfmt/2.2-configuration.html#discovery-implementation)
* [Ruby API for Configuration](https://deepwiki.com/fs0414/rfmt/2.2-configuration.html#ruby-api-for-configuration)
* [Configuration Structure](https://deepwiki.com/fs0414/rfmt/2.2-configuration.html#configuration-structure)
* [Configuration Schema to Code Mapping](https://deepwiki.com/fs0414/rfmt/2.2-configuration.html#configuration-schema-to-code-mapping)
* [Complete Configuration Example](https://deepwiki.com/fs0414/rfmt/2.2-configuration.html#complete-configuration-example)
* [Formatting Options](https://deepwiki.com/fs0414/rfmt/2.2-configuration.html#formatting-options)
* [Core Formatting Options](https://deepwiki.com/fs0414/rfmt/2.2-configuration.html#core-formatting-options)
* [Option Details](https://deepwiki.com/fs0414/rfmt/2.2-configuration.html#option-details)
* [`line\_length`](https://deepwiki.com/fs0414/rfmt/2.2-configuration.html#line_length)
* [`indent\_width`](https://deepwiki.com/fs0414/rfmt/2.2-configuration.html#indent_width)
* [`indent\_style`](https://deepwiki.com/fs0414/rfmt/2.2-configuration.html#indent_style)
* [`quote\_style`](https://deepwiki.com/fs0414/rfmt/2.2-configuration.html#quote_style)
* [Style Sub-options](https://deepwiki.com/fs0414/rfmt/2.2-configuration.html#style-sub-options)
* [File Selection Patterns](https://deepwiki.com/fs0414/rfmt/2.2-configuration.html#file-selection-patterns)
* [Pattern Processing Flow](https://deepwiki.com/fs0414/rfmt/2.2-configuration.html#pattern-processing-flow)
* [Default Patterns](https://deepwiki.com/fs0414/rfmt/2.2-configuration.html#default-patterns)
* [Pattern Precedence](https://deepwiki.com/fs0414/rfmt/2.2-configuration.html#pattern-precedence)
* [Environment Variables](https://deepwiki.com/fs0414/rfmt/2.2-configuration.html#environment-variables)
* [Environment Variables to Code Mapping](https://deepwiki.com/fs0414/rfmt/2.2-configuration.html#environment-variables-to-code-mapping)
* [Available Environment Variables](https://deepwiki.com/fs0414/rfmt/2.2-configuration.html#available-environment-variables)
* [Usage Examples](https://deepwiki.com/fs0414/rfmt/2.2-configuration.html#usage-examples)
* [Validation and Defaults](https://deepwiki.com/fs0414/rfmt/2.2-configuration.html#validation-and-defaults)
* [Validation Rules](https://deepwiki.com/fs0414/rfmt/2.2-configuration.html#validation-rules)
* [Validation Implementation](https://deepwiki.com/fs0414/rfmt/2.2-configuration.html#validation-implementation)
* [Default Values](https://deepwiki.com/fs0414/rfmt/2.2-configuration.html#default-values)
* [Partial Configuration](https://deepwiki.com/fs0414/rfmt/2.2-configuration.html#partial-configuration)
