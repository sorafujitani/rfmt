---
title: "Ruby API | fs0414/rfmt | DeepWiki"
source_url: "https://deepwiki.com/fs0414/rfmt/3.2-ruby-api"
fetched_at: "2026-01-13T10:53:43.101777+00:00"
---



Loading...

Index your code with Devin

[DeepWiki](https://deepwiki.com/)

[DeepWiki](https://deepwiki.com/)

[fs0414/rfmt](https://github.com/fs0414/rfmt "Open repository")

Index your code with

Devin

Edit WikiShare

Loading...

Last indexed: 3 January 2026 ([90c575](https://github.com/fs0414/rfmt/commits/90c575e6))

* [Overview](https://deepwiki.com/fs0414/rfmt/1-overview.html)
* [Architecture Overview](https://deepwiki.com/fs0414/rfmt/1.1-architecture-overview.html)
* [Key Concepts](https://deepwiki.com/fs0414/rfmt/1.2-key-concepts.html)
* [Getting Started](https://deepwiki.com/fs0414/rfmt/2-getting-started.html)
* [Installation](https://deepwiki.com/fs0414/rfmt/2.1-installation.html)
* [Configuration](https://deepwiki.com/fs0414/rfmt/2.2-configuration.html)
* [User Guides](https://deepwiki.com/fs0414/rfmt/3-user-guides.html)
* [CLI Usage](https://deepwiki.com/fs0414/rfmt/3.1-cli-usage.html)
* [Ruby API](https://deepwiki.com/fs0414/rfmt/3.2-ruby-api.html)
* [Editor Integration](https://deepwiki.com/fs0414/rfmt/3.3-editor-integration.html)
* [Core Systems](https://deepwiki.com/fs0414/rfmt/4-core-systems.html)
* [AST Representation](https://deepwiki.com/fs0414/rfmt/4.1-ast-representation.html)
* [Formatting Engine (Emitter)](https://deepwiki.com/fs0414/rfmt/4.2-formatting-engine-(emitter).html)
* [Parser Integration (PrismBridge)](https://deepwiki.com/fs0414/rfmt/4.3-parser-integration-(prismbridge).html)
* [Configuration System](https://deepwiki.com/fs0414/rfmt/4.4-configuration-system.html)
* [Caching System](https://deepwiki.com/fs0414/rfmt/4.5-caching-system.html)
* [Logging System](https://deepwiki.com/fs0414/rfmt/4.6-logging-system.html)
* [Formatting Behavior](https://deepwiki.com/fs0414/rfmt/5-formatting-behavior.html)
* [Control Flow Formatting](https://deepwiki.com/fs0414/rfmt/5.1-control-flow-formatting.html)
* [Exception Handling Formatting](https://deepwiki.com/fs0414/rfmt/5.2-exception-handling-formatting.html)
* [Lambda and Block Formatting](https://deepwiki.com/fs0414/rfmt/5.3-lambda-and-block-formatting.html)
* [Development](https://deepwiki.com/fs0414/rfmt/6-development.html)
* [Building from Source](https://deepwiki.com/fs0414/rfmt/6.1-building-from-source.html)
* [Testing](https://deepwiki.com/fs0414/rfmt/6.2-testing.html)
* [Release Process](https://deepwiki.com/fs0414/rfmt/6.3-release-process.html)
* [Reference](https://deepwiki.com/fs0414/rfmt/7-reference.html)
* [Node Types Reference](https://deepwiki.com/fs0414/rfmt/7.1-node-types-reference.html)
* [Configuration Options Reference](https://deepwiki.com/fs0414/rfmt/7.2-configuration-options-reference.html)
* [Error Codes Reference](https://deepwiki.com/fs0414/rfmt/7.3-error-codes-reference.html)
* [Performance and Benchmarks](https://deepwiki.com/fs0414/rfmt/7.4-performance-and-benchmarks.html)

Menu

# Ruby API

Relevant source files

* [README.md](https://github.com/fs0414/rfmt/blob/90c575e6/README.md)
* [docs/user\_guide.ja.md](https://github.com/fs0414/rfmt/blob/90c575e6/docs/user_guide.ja.md)
* [docs/user\_guide.md](https://github.com/fs0414/rfmt/blob/90c575e6/docs/user_guide.md)
* [spec/config\_management\_spec.rb](https://github.com/fs0414/rfmt/blob/90c575e6/spec/config_management_spec.rb)
* [spec/rfmt\_spec.rb](https://github.com/fs0414/rfmt/blob/90c575e6/spec/rfmt_spec.rb)

The Ruby API provides programmatic access to rfmt's formatting capabilities. It enables integration into custom Ruby scripts, Rake tasks, CI/CD systems, and editor plugins. This API is the primary interface for embedding rfmt into other tools.

**Related pages:** For command-line usage, see [CLI Usage](https://deepwiki.com/fs0414/rfmt/3.1-cli-usage.html). For editor-specific integrations, see [Editor Integration](https://deepwiki.com/fs0414/rfmt/3.3-editor-integration.html). For configuration file structure, see [Configuration](https://deepwiki.com/fs0414/rfmt/2.2-configuration.html).

## API Surface Overview

The Ruby API consists of three main modules and several error classes exposed for programmatic formatting and configuration management:

**Sources:** [README.md189-248](https://github.com/fs0414/rfmt/blob/90c575e6/README.md#L189-L248) [spec/rfmt\_spec.rb1-90](https://github.com/fs0414/rfmt/blob/90c575e6/spec/rfmt_spec.rb#L1-L90) [spec/config\_management\_spec.rb1-154](https://github.com/fs0414/rfmt/blob/90c575e6/spec/config_management_spec.rb#L1-L154)

## Core Formatting API

### Rfmt.format

The `Rfmt.format` method is the primary entry point for formatting Ruby source code. It accepts unformatted Ruby source as a string and returns formatted output.

**Method Signature:**

**Parameters:**

| Parameter | Type | Required | Description |
| --- | --- | --- | --- |
| `source` | String | Yes | Ruby source code to format |
| `config` | Hash | No | Override configuration (merged with discovered config) |

**Return Value:** Formatted Ruby source code as a `String`.

**Basic Usage:**

**With Configuration Override:**

The configuration hash follows the same structure as `.rfmt.yml` files. Provided options override discovered configuration but do not replace it entirely.

**Sources:** [README.md189-217](https://github.com/fs0414/rfmt/blob/90c575e6/README.md#L189-L217) [spec/rfmt\_spec.rb6-78](https://github.com/fs0414/rfmt/blob/90c575e6/spec/rfmt_spec.rb#L6-L78) [docs/user\_guide.md232-271](https://github.com/fs0414/rfmt/blob/90c575e6/docs/user_guide.md#L232-L271)

### Format Operation Flow

The following diagram illustrates the internal flow when `Rfmt.format` is invoked:

**Sources:** [README.md189-217](https://github.com/fs0414/rfmt/blob/90c575e6/README.md#L189-L217) [docs/user\_guide.md232-271](https://github.com/fs0414/rfmt/blob/90c575e6/docs/user_guide.md#L232-L271)

### Rfmt.version\_info

Returns version information for both Ruby and Rust components.

**Method Signature:**

**Return Value:** Multi-line string containing version details.

**Usage:**

**Sources:** [spec/rfmt\_spec.rb80-88](https://github.com/fs0414/rfmt/blob/90c575e6/spec/rfmt_spec.rb#L80-L88)

## Configuration Management API

The `Rfmt::Config` module provides methods for creating, discovering, loading, and validating configuration files.

### Configuration Discovery Pattern

**Sources:** [README.md220-248](https://github.com/fs0414/rfmt/blob/90c575e6/README.md#L220-L248) [docs/user\_guide.md120-128](https://github.com/fs0414/rfmt/blob/90c575e6/docs/user_guide.md#L120-L128)

### Rfmt::Config.init

Creates a new configuration file with default settings.

**Method Signature:**

**Parameters:**

| Parameter | Type | Required | Default | Description |
| --- | --- | --- | --- | --- |
| `path` | String | Yes | - | Path where config file will be created |
| `force` | Boolean | No | false | If true, overwrites existing file |

**Return Value:** `true` if file created successfully, `false` if file exists and `force` is `false`.

**Usage:**

The generated file contains the default configuration template from `Rfmt::Config::DEFAULT_CONFIG`.

**Sources:** [README.md114-153](https://github.com/fs0414/rfmt/blob/90c575e6/README.md#L114-L153) [spec/config\_management\_spec.rb9-54](https://github.com/fs0414/rfmt/blob/90c575e6/spec/config_management_spec.rb#L9-L54)

### Rfmt::Config.load

Loads configuration from a file and returns it as a hash.

**Method Signature:**

**Parameters:**

| Parameter | Type | Required | Description |
| --- | --- | --- | --- |
| `path` | String | No | Explicit path to config file. If nil, uses discovery process |

**Return Value:** Hash containing parsed configuration.

**Raises:**

* `Rfmt::Error` if file not found
* `Rfmt::Error` if YAML is invalid

**Usage:**

**Configuration Structure:**

The returned hash follows this structure:

**Sources:** [README.md229-248](https://github.com/fs0414/rfmt/blob/90c575e6/README.md#L229-L248) [spec/config\_management\_spec.rb56-92](https://github.com/fs0414/rfmt/blob/90c575e6/spec/config_management_spec.rb#L56-L92)

### Rfmt::Config.find

Searches for a configuration file using the discovery process and returns its path.

**Method Signature:**

**Return Value:** Absolute path to discovered config file, or `nil` if not found.

**Usage:**

**Sources:** [README.md237-239](https://github.com/fs0414/rfmt/blob/90c575e6/README.md#L237-L239)

### Rfmt::Config.exists?

Checks whether a configuration file exists in the discoverable locations.

**Method Signature:**

**Return Value:** `true` if config file found, `false` otherwise.

**Usage:**

**Sources:** [README.md241-243](https://github.com/fs0414/rfmt/blob/90c575e6/README.md#L241-L243) [spec/config\_management\_spec.rb94-104](https://github.com/fs0414/rfmt/blob/90c575e6/spec/config_management_spec.rb#L94-L104)

### Rfmt::Config::DEFAULT\_CONFIG

A string constant containing the default configuration template in YAML format.

**Usage:**

The constant contains the same content that `Rfmt::Config.init` writes to files.

**Sources:** [spec/config\_management\_spec.rb106-152](https://github.com/fs0414/rfmt/blob/90c575e6/spec/config_management_spec.rb#L106-L152)

## AST Parsing API

### Rfmt::PrismBridge.parse

Parses Ruby source code into a JSON representation of the AST (Abstract Syntax Tree). This is primarily used internally by `Rfmt.format` but is exposed for advanced use cases like AST inspection or custom tooling.

**Method Signature:**

**Parameters:**

| Parameter | Type | Required | Description |
| --- | --- | --- | --- |
| `source` | String | Yes | Ruby source code to parse |

**Return Value:** JSON string containing AST structure, comments, and location information.

**Usage:**

**AST JSON Structure:**

The returned JSON follows this structure:

**Raises:** `Rfmt::ParseError` if source contains syntax errors.

**Sources:** [README.md273-287](https://github.com/fs0414/rfmt/blob/90c575e6/README.md#L273-L287) [docs/user\_guide.ja.md274-288](https://github.com/fs0414/rfmt/blob/90c575e6/docs/user_guide.ja.md#L274-L288)

### PrismBridge Internal Flow

**Sources:** [docs/user\_guide.md273-287](https://github.com/fs0414/rfmt/blob/90c575e6/docs/user_guide.md#L273-L287)

## Error Handling

rfmt provides structured error classes for different failure scenarios. All errors inherit from `Rfmt::Error`, enabling broad or specific rescue clauses.

### Error Class Hierarchy

**Sources:** [docs/user\_guide.md289-305](https://github.com/fs0414/rfmt/blob/90c575e6/docs/user_guide.md#L289-L305) [docs/user\_guide.ja.md290-306](https://github.com/fs0414/rfmt/blob/90c575e6/docs/user_guide.ja.md#L290-L306)

### Rfmt::Error

Base exception class for all rfmt errors.

**Usage:**

**Sources:** [spec/rfmt\_spec.rb24-30](https://github.com/fs0414/rfmt/blob/90c575e6/spec/rfmt_spec.rb#L24-L30)

### Rfmt::ParseError

Raised when source code contains Ruby syntax errors. This error includes detailed location information and code snippets to help identify the issue.

**Error Message Format:**

```
[Rfmt::ParseError] Parse error in example.rb:5:10
Expected closing 'end' for class definition

Code:
   3 | class User
   4 |   def initialize
   5 |     @name = name
     |          ^
   6 | end
```

**Usage:**

**Sources:** [docs/user\_guide.md290-305](https://github.com/fs0414/rfmt/blob/90c575e6/docs/user_guide.md#L290-L305) [docs/user\_guide.ja.md292-306](https://github.com/fs0414/rfmt/blob/90c575e6/docs/user_guide.ja.md#L292-L306)

### Rfmt::ConfigError

Raised when configuration files are invalid or cannot be loaded.

**Common Causes:**

* Invalid YAML syntax
* Missing required configuration keys
* Configuration values outside valid ranges (e.g., `line_length: 10`)
* File permissions issues

**Usage:**

**Sources:** [spec/config\_management\_spec.rb76-91](https://github.com/fs0414/rfmt/blob/90c575e6/spec/config_management_spec.rb#L76-L91)

### Error Handling Patterns

**Pattern 1: Catch all rfmt errors**

**Pattern 2: Handle specific error types**

**Pattern 3: Silent fallback**

**Sources:** [docs/user\_guide.md289-305](https://github.com/fs0414/rfmt/blob/90c575e6/docs/user_guide.md#L289-L305)

## Integration Patterns

### Rake Task Integration

Create a Rake task for formatting your project:

**Sources:** [docs/user\_guide.md1-559](https://github.com/fs0414/rfmt/blob/90c575e6/docs/user_guide.md#L1-L559)

### Custom Script Integration

Format files with custom logic:

**Sources:** [README.md189-217](https://github.com/fs0414/rfmt/blob/90c575e6/README.md#L189-L217)

### Test Helper Integration

Ensure formatted code in tests:

**Sources:** [spec/rfmt\_spec.rb1-90](https://github.com/fs0414/rfmt/blob/90c575e6/spec/rfmt_spec.rb#L1-L90)

### Programmatic Configuration

Override configuration programmatically for different contexts:

**Sources:** [docs/user\_guide.md258-271](https://github.com/fs0414/rfmt/blob/90c575e6/docs/user_guide.md#L258-L271)

## API Method Reference

### Summary Table

| Method | Parameters | Returns | Purpose |
| --- | --- | --- | --- |
| `Rfmt.format` | `source` (String) `config:` (Hash, optional) | String | Format Ruby source code |
| `Rfmt.version_info` | None | String | Get version information |
| `Rfmt::Config.init` | `path` (String) `force:` (Boolean, default: false) | Boolean | Create configuration file |
| `Rfmt::Config.load` | `path` (String, optional) | Hash | Load configuration |
| `Rfmt::Config.find` | None | String or nil | Find configuration path |
| `Rfmt::Config.exists?` | None | Boolean | Check if config exists |
| `Rfmt::PrismBridge.parse` | `source` (String) | String (JSON) | Parse source to AST |

**Sources:** [README.md189-248](https://github.com/fs0414/rfmt/blob/90c575e6/README.md#L189-L248) [spec/rfmt\_spec.rb1-90](https://github.com/fs0414/rfmt/blob/90c575e6/spec/rfmt_spec.rb#L1-L90) [spec/config\_management\_spec.rb1-154](https://github.com/fs0414/rfmt/blob/90c575e6/spec/config_management_spec.rb#L1-L154)

### Error Reference

| Exception Class | Parent | Raised When |
| --- | --- | --- |
| `Rfmt::Error` | `StandardError` | Any rfmt-related error |
| `Rfmt::ParseError` | `Rfmt::Error` | Source has syntax errors |
| `Rfmt::ConfigError` | `Rfmt::Error` | Configuration is invalid |

**Sources:** [docs/user\_guide.md308-342](https://github.com/fs0414/rfmt/blob/90c575e6/docs/user_guide.md#L308-L342)

Dismiss

Refresh this wiki

Enter email to refresh

### On this page

* [Ruby API](https://deepwiki.com/fs0414/rfmt/3.2-ruby-api.html#ruby-api)
* [API Surface Overview](https://deepwiki.com/fs0414/rfmt/3.2-ruby-api.html#api-surface-overview)
* [Core Formatting API](https://deepwiki.com/fs0414/rfmt/3.2-ruby-api.html#core-formatting-api)
* [Rfmt.format](https://deepwiki.com/fs0414/rfmt/3.2-ruby-api.html#rfmtformat)
* [Format Operation Flow](https://deepwiki.com/fs0414/rfmt/3.2-ruby-api.html#format-operation-flow)
* [Rfmt.version\_info](https://deepwiki.com/fs0414/rfmt/3.2-ruby-api.html#rfmtversion_info)
* [Configuration Management API](https://deepwiki.com/fs0414/rfmt/3.2-ruby-api.html#configuration-management-api)
* [Configuration Discovery Pattern](https://deepwiki.com/fs0414/rfmt/3.2-ruby-api.html#configuration-discovery-pattern)
* [Rfmt::Config.init](https://deepwiki.com/fs0414/rfmt/3.2-ruby-api.html#rfmtconfiginit)
* [Rfmt::Config.load](https://deepwiki.com/fs0414/rfmt/3.2-ruby-api.html#rfmtconfigload)
* [Rfmt::Config.find](https://deepwiki.com/fs0414/rfmt/3.2-ruby-api.html#rfmtconfigfind)
* [Rfmt::Config.exists?](https://deepwiki.com/fs0414/rfmt/3.2-ruby-api.html#rfmtconfigexists)
* [Rfmt::Config::DEFAULT\_CONFIG](https://deepwiki.com/fs0414/rfmt/3.2-ruby-api.html#rfmtconfigdefault_config)
* [AST Parsing API](https://deepwiki.com/fs0414/rfmt/3.2-ruby-api.html#ast-parsing-api)
* [Rfmt::PrismBridge.parse](https://deepwiki.com/fs0414/rfmt/3.2-ruby-api.html#rfmtprismbridgeparse)
* [PrismBridge Internal Flow](https://deepwiki.com/fs0414/rfmt/3.2-ruby-api.html#prismbridge-internal-flow)
* [Error Handling](https://deepwiki.com/fs0414/rfmt/3.2-ruby-api.html#error-handling)
* [Error Class Hierarchy](https://deepwiki.com/fs0414/rfmt/3.2-ruby-api.html#error-class-hierarchy)
* [Rfmt::Error](https://deepwiki.com/fs0414/rfmt/3.2-ruby-api.html#rfmterror)
* [Rfmt::ParseError](https://deepwiki.com/fs0414/rfmt/3.2-ruby-api.html#rfmtparseerror)
* [Rfmt::ConfigError](https://deepwiki.com/fs0414/rfmt/3.2-ruby-api.html#rfmtconfigerror)
* [Error Handling Patterns](https://deepwiki.com/fs0414/rfmt/3.2-ruby-api.html#error-handling-patterns)
* [Integration Patterns](https://deepwiki.com/fs0414/rfmt/3.2-ruby-api.html#integration-patterns)
* [Rake Task Integration](https://deepwiki.com/fs0414/rfmt/3.2-ruby-api.html#rake-task-integration)
* [Custom Script Integration](https://deepwiki.com/fs0414/rfmt/3.2-ruby-api.html#custom-script-integration)
* [Test Helper Integration](https://deepwiki.com/fs0414/rfmt/3.2-ruby-api.html#test-helper-integration)
* [Programmatic Configuration](https://deepwiki.com/fs0414/rfmt/3.2-ruby-api.html#programmatic-configuration)
* [API Method Reference](https://deepwiki.com/fs0414/rfmt/3.2-ruby-api.html#api-method-reference)
* [Summary Table](https://deepwiki.com/fs0414/rfmt/3.2-ruby-api.html#summary-table)
* [Error Reference](https://deepwiki.com/fs0414/rfmt/3.2-ruby-api.html#error-reference)
