---
title: "Control Flow Formatting | fs0414/rfmt | DeepWiki"
source_url: "https://deepwiki.com/fs0414/rfmt/5.1-control-flow-formatting"
fetched_at: "2026-01-13T10:53:43.101777+00:00"
---



Loading...

Index your code with Devin

[DeepWiki](https://deepwiki.com/)

[DeepWiki](https://deepwiki.com/)

[fs0414/rfmt](https://github.com/fs0414/rfmt "Open repository")

Index your code with

Devin

Edit WikiShare

Loading...

Last indexed: 3 January 2026 ([90c575](https://github.com/fs0414/rfmt/commits/90c575e6))

* [Overview](https://deepwiki.com/fs0414/rfmt/1-overview.html)
* [Architecture Overview](https://deepwiki.com/fs0414/rfmt/1.1-architecture-overview.html)
* [Key Concepts](https://deepwiki.com/fs0414/rfmt/1.2-key-concepts.html)
* [Getting Started](https://deepwiki.com/fs0414/rfmt/2-getting-started.html)
* [Installation](https://deepwiki.com/fs0414/rfmt/2.1-installation.html)
* [Configuration](https://deepwiki.com/fs0414/rfmt/2.2-configuration.html)
* [User Guides](https://deepwiki.com/fs0414/rfmt/3-user-guides.html)
* [CLI Usage](https://deepwiki.com/fs0414/rfmt/3.1-cli-usage.html)
* [Ruby API](https://deepwiki.com/fs0414/rfmt/3.2-ruby-api.html)
* [Editor Integration](https://deepwiki.com/fs0414/rfmt/3.3-editor-integration.html)
* [Core Systems](https://deepwiki.com/fs0414/rfmt/4-core-systems.html)
* [AST Representation](https://deepwiki.com/fs0414/rfmt/4.1-ast-representation.html)
* [Formatting Engine (Emitter)](https://deepwiki.com/fs0414/rfmt/4.2-formatting-engine-(emitter).html)
* [Parser Integration (PrismBridge)](https://deepwiki.com/fs0414/rfmt/4.3-parser-integration-(prismbridge).html)
* [Configuration System](https://deepwiki.com/fs0414/rfmt/4.4-configuration-system.html)
* [Caching System](https://deepwiki.com/fs0414/rfmt/4.5-caching-system.html)
* [Logging System](https://deepwiki.com/fs0414/rfmt/4.6-logging-system.html)
* [Formatting Behavior](https://deepwiki.com/fs0414/rfmt/5-formatting-behavior.html)
* [Control Flow Formatting](https://deepwiki.com/fs0414/rfmt/5.1-control-flow-formatting.html)
* [Exception Handling Formatting](https://deepwiki.com/fs0414/rfmt/5.2-exception-handling-formatting.html)
* [Lambda and Block Formatting](https://deepwiki.com/fs0414/rfmt/5.3-lambda-and-block-formatting.html)
* [Development](https://deepwiki.com/fs0414/rfmt/6-development.html)
* [Building from Source](https://deepwiki.com/fs0414/rfmt/6.1-building-from-source.html)
* [Testing](https://deepwiki.com/fs0414/rfmt/6.2-testing.html)
* [Release Process](https://deepwiki.com/fs0414/rfmt/6.3-release-process.html)
* [Reference](https://deepwiki.com/fs0414/rfmt/7-reference.html)
* [Node Types Reference](https://deepwiki.com/fs0414/rfmt/7.1-node-types-reference.html)
* [Configuration Options Reference](https://deepwiki.com/fs0414/rfmt/7.2-configuration-options-reference.html)
* [Error Codes Reference](https://deepwiki.com/fs0414/rfmt/7.3-error-codes-reference.html)
* [Performance and Benchmarks](https://deepwiki.com/fs0414/rfmt/7.4-performance-and-benchmarks.html)

Menu

# Control Flow Formatting

Relevant source files

* [ext/rfmt/src/emitter/mod.rs](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs)
* [lib/rfmt/prism\_bridge.rb](https://github.com/fs0414/rfmt/blob/90c575e6/lib/rfmt/prism_bridge.rb)
* [lib/rfmt/prism\_node\_extractor.rb](https://github.com/fs0414/rfmt/blob/90c575e6/lib/rfmt/prism_node_extractor.rb)
* [spec/case\_formatting\_spec.rb](https://github.com/fs0414/rfmt/blob/90c575e6/spec/case_formatting_spec.rb)
* [spec/conditional\_formatting\_spec.rb](https://github.com/fs0414/rfmt/blob/90c575e6/spec/conditional_formatting_spec.rb)
* [spec/loop\_formatting\_spec.rb](https://github.com/fs0414/rfmt/blob/90c575e6/spec/loop_formatting_spec.rb)

This page documents how rfmt formats Ruby control flow constructs including conditionals (if/unless/elsif/else), case statements, loops (while/until/for), and loop control keywords. These formatting rules ensure consistent indentation, proper spacing, and preservation of modifier forms where appropriate.

For exception handling formatting (begin/rescue/ensure), see [Exception Handling Formatting](https://deepwiki.com/fs0414/rfmt/5.2-exception-handling-formatting.html). For lambda and block formatting (do-end blocks, stabby lambdas), see [Lambda and Block Formatting](https://deepwiki.com/fs0414/rfmt/5.3-lambda-and-block-formatting.html).

---

## Conditional Statement Formatting

rfmt formats conditional statements (if/unless) in three distinct forms: block conditionals, postfix conditionals, and ternary operators. Each form has specific formatting rules.

### Block If/Unless/Elsif/Else

Block conditionals use the standard multi-line format with consistent indentation. The emitter applies these rules:

| Element | Rule |
| --- | --- |
| `if`/`unless` keyword | Aligned with surrounding code |
| Predicate (condition) | Inline after keyword, extracted from source |
| Body statements | Indented one level from keyword |
| `elsif` clauses | Aligned with `if` keyword |
| `else` clause | Aligned with `if` keyword |
| `end` keyword | Aligned with `if` keyword |

**Example:**

The implementation distinguishes between block and postfix forms by comparing source positions: in postfix form, the statements node appears before the predicate in source offset order [ext/rfmt/src/emitter/mod.rs659-665](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L659-L665)

**Sources:** [ext/rfmt/src/emitter/mod.rs650-823](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L650-L823) [spec/conditional\_formatting\_spec.rb6-29](https://github.com/fs0414/rfmt/blob/90c575e6/spec/conditional_formatting_spec.rb#L6-L29) [spec/conditional\_formatting\_spec.rb31-50](https://github.com/fs0414/rfmt/blob/90c575e6/spec/conditional_formatting_spec.rb#L31-L50)

### Postfix Conditionals (Modifier Form)

Postfix conditionals (statement modifiers) are preserved in their single-line form. The emitter detects these by checking if the statements node's start offset is less than the predicate's start offset [ext/rfmt/src/emitter/mod.rs659-665](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L659-L665)

**Formatting rule:** `<statement> if <condition>` or `<statement> unless <condition>`

**Example:**

The emitter extracts both the statement and condition from source text to preserve exact formatting [ext/rfmt/src/emitter/mod.rs668-700](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L668-L700)

**Sources:** [ext/rfmt/src/emitter/mod.rs668-700](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L668-L700) [spec/conditional\_formatting\_spec.rb52-56](https://github.com/fs0414/rfmt/blob/90c575e6/spec/conditional_formatting_spec.rb#L52-L56)

### Ternary Operators

Ternary operators (`condition ? true_expr : false_expr`) are detected via metadata flag `is_ternary` set by the Ruby parser [lib/rfmt/prism\_bridge.rb363-365](https://github.com/fs0414/rfmt/blob/90c575e6/lib/rfmt/prism_bridge.rb#L363-L365) The emitter preserves them in single-line format with standard spacing.

**Formatting rule:** `<condition> ? <true_expr> : <false_expr>`

The implementation extracts the condition, then-expression, and else-expression from source, formatting them with `?` and `:` separators [ext/rfmt/src/emitter/mod.rs709-753](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L709-L753)

**Sources:** [ext/rfmt/src/emitter/mod.rs702-753](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L702-L753) [lib/rfmt/prism\_bridge.rb363-365](https://github.com/fs0414/rfmt/blob/90c575e6/lib/rfmt/prism_bridge.rb#L363-L365)

### Nested Conditionals

Nested conditionals receive proper cascading indentation. Each nested level increases indentation by one level (default: 2 spaces).

**Example:**

**Sources:** [spec/conditional\_formatting\_spec.rb58-77](https://github.com/fs0414/rfmt/blob/90c575e6/spec/conditional_formatting_spec.rb#L58-L77)

---

## Control Flow Dispatch Architecture

The following diagram shows how control flow nodes are dispatched from the main `emit_node` method to specialized formatters:

**Sources:** [ext/rfmt/src/emitter/mod.rs149-171](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L149-L171) [ext/rfmt/src/emitter/mod.rs650-823](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L650-L823)

---

## Case/When Statement Formatting

Case statements are formatted with consistent indentation across `when` clauses and optional `else` clause. The structure follows Ruby's standard alignment conventions.

### Formatting Rules

| Element | Rule |
| --- | --- |
| `case` keyword | Aligned with surrounding code |
| Predicate | Inline after `case`, extracted from source |
| `when` keyword | Aligned with `case` |
| When conditions | Inline after `when`, comma-separated |
| When body | Indented one level from `when` |
| `else` clause | Aligned with `when` |
| `end` keyword | Aligned with `case` |

**Example:**

### Implementation Details

The `emit_case` method handles the case structure [ext/rfmt/src/emitter/mod.rs549-605](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L549-L605):

1. Emits `case` keyword
2. Identifies predicate (first non-WhenNode, non-ElseNode child)
3. Iterates through children, emitting `when` clauses via `emit_when`
4. Handles optional `else` clause
5. Closes with `end` keyword

The `emit_when` method formats each when clause [ext/rfmt/src/emitter/mod.rs607-645](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L607-L645):

1. Emits `when` keyword
2. Collects condition nodes (all non-StatementsNode children)
3. Extracts condition text from source, joining multiple conditions with `,`
4. Emits body statements with increased indentation

**Sources:** [ext/rfmt/src/emitter/mod.rs549-645](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L549-L645) [spec/case\_formatting\_spec.rb1-22](https://github.com/fs0414/rfmt/blob/90c575e6/spec/case_formatting_spec.rb#L1-L22)

---

## Loop Construct Formatting

rfmt supports three types of loops: `while`, `until`, and `for`. Each maintains consistent formatting with proper indentation.

### While/Until Loops

While and until loops share the same formatting logic, differing only in keyword [ext/rfmt/src/emitter/mod.rs1003-1025](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L1003-L1025)

**Formatting rule:**

**Example:**

The implementation extracts the predicate from source and formats the body with proper indentation:

**Sources:** [ext/rfmt/src/emitter/mod.rs1003-1025](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L1003-L1025) [spec/loop\_formatting\_spec.rb6-19](https://github.com/fs0414/rfmt/blob/90c575e6/spec/loop_formatting_spec.rb#L6-L19)

### For Loops

For loops iterate over collections with explicit index variables.

**Formatting rule:**

**Example:**

The `emit_for` implementation [ext/rfmt/src/emitter/mod.rs1027-1049](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L1027-L1049):

1. Emits `for` keyword
2. Extracts index variable and collection from source
3. Formats body statements with increased indentation
4. Closes with `end` keyword

**Sources:** [ext/rfmt/src/emitter/mod.rs1027-1049](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L1027-L1049) [spec/loop\_formatting\_spec.rb21-26](https://github.com/fs0414/rfmt/blob/90c575e6/spec/loop_formatting_spec.rb#L21-L26)

---

## Loop Control Keywords

Loop control keywords (`break`, `next`, `redo`, `retry`) are formatted using the generic emitter since they have simple syntax without special structural requirements.

### Formatting Rules

| Keyword | Purpose | Format |
| --- | --- | --- |
| `break` | Exit loop | `break` or `break <value>` |
| `next` | Skip to next iteration | `next` or `next <value>` |
| `redo` | Restart current iteration | `redo` |
| `retry` | Restart entire loop | `retry` |

### Postfix Form Support

Loop control keywords support postfix conditional form, which is preserved:

**Example:**

The child extraction logic in PrismBridge handles these nodes by extracting their optional arguments [lib/rfmt/prism\_bridge.rb221-224](https://github.com/fs0414/rfmt/blob/90c575e6/lib/rfmt/prism_bridge.rb#L221-L224)

**Sources:** [ext/rfmt/src/emitter/mod.rs168](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L168-L168) [lib/rfmt/prism\_bridge.rb221-227](https://github.com/fs0414/rfmt/blob/90c575e6/lib/rfmt/prism_bridge.rb#L221-L227) [spec/loop\_formatting\_spec.rb28-34](https://github.com/fs0414/rfmt/blob/90c575e6/spec/loop_formatting_spec.rb#L28-L34)

---

## AST Structure for Control Flow

The following diagram illustrates how Prism AST nodes are converted to rfmt's internal representation for control flow constructs:

**Sources:** [lib/rfmt/prism\_bridge.rb86-98](https://github.com/fs0414/rfmt/blob/90c575e6/lib/rfmt/prism_bridge.rb#L86-L98) [lib/rfmt/prism\_bridge.rb122-307](https://github.com/fs0414/rfmt/blob/90c575e6/lib/rfmt/prism_bridge.rb#L122-L307) [lib/rfmt/prism\_bridge.rb310-368](https://github.com/fs0414/rfmt/blob/90c575e6/lib/rfmt/prism_bridge.rb#L310-L368) [ext/rfmt/src/emitter/mod.rs149-171](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L149-L171)

---

## Child Node Extraction for Control Flow

The PrismBridge extracts children from control flow nodes following these patterns:

### IfNode / UnlessNode Children

Extracted at [lib/rfmt/prism\_bridge.rb156-161](https://github.com/fs0414/rfmt/blob/90c575e6/lib/rfmt/prism_bridge.rb#L156-L161) as: `[predicate, statements, consequent].compact`

### CaseNode Children

Extracted at [lib/rfmt/prism\_bridge.rb214](https://github.com/fs0414/rfmt/blob/90c575e6/lib/rfmt/prism_bridge.rb#L214-L214) as: `[predicate, *conditions, else_clause].compact`

### WhileNode / UntilNode Children

Extracted at [lib/rfmt/prism\_bridge.rb218](https://github.com/fs0414/rfmt/blob/90c575e6/lib/rfmt/prism_bridge.rb#L218-L218) as: `[predicate, statements].compact`

### ForNode Children

Extracted at [lib/rfmt/prism\_bridge.rb220](https://github.com/fs0414/rfmt/blob/90c575e6/lib/rfmt/prism_bridge.rb#L220-L220) as: `[index, collection, statements].compact`

**Sources:** [lib/rfmt/prism\_bridge.rb122-227](https://github.com/fs0414/rfmt/blob/90c575e6/lib/rfmt/prism_bridge.rb#L122-L227)

---

## Indentation Management

Control flow constructs follow rfmt's standard indentation rules. Each nested level increases indentation according to configuration:

| Configuration | Default | Range | Effect |
| --- | --- | --- | --- |
| `indent_width` | 2 | 1-8 | Spaces per level |
| `indent_style` | `spaces` | `spaces` or `tabs` | Character type |

The emitter calculates indent strings dynamically [ext/rfmt/src/emitter/mod.rs95-98](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L95-L98):

```
indent_str = " " × (indent_width × indent_level)  // for spaces
indent_str = "\t" × indent_level                  // for tabs
```

Control flow bodies are emitted at `indent_level + 1` [ext/rfmt/src/emitter/mod.rs787](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L787-L787) [ext/rfmt/src/emitter/mod.rs1016](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L1016-L1016)

**Sources:** [ext/rfmt/src/emitter/mod.rs95-98](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L95-L98) [ext/rfmt/src/emitter/mod.rs787](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L787-L787) [ext/rfmt/src/emitter/mod.rs1016](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L1016-L1016)

---

## Comment Preservation in Control Flow

Comments are preserved at their original positions relative to control flow constructs. The emitter handles three comment positions:

1. **Before constructs:** Comments preceding control flow keywords [ext/rfmt/src/emitter/mod.rs94-123](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L94-L123)
2. **Trailing on same line:** Comments after keywords on the definition line [ext/rfmt/src/emitter/mod.rs126-146](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L126-L146)
3. **Within bodies:** Comments between statements

**Example with comments:**

The emitter emits comments before control flow keywords via `emit_comments_before` [ext/rfmt/src/emitter/mod.rs757](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L757-L757) [ext/rfmt/src/emitter/mod.rs609](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L609-L609) and trailing comments via `emit_trailing_comments` [ext/rfmt/src/emitter/mod.rs781](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L781-L781)

**Sources:** [ext/rfmt/src/emitter/mod.rs94-146](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L94-L146) [ext/rfmt/src/emitter/mod.rs757](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L757-L757) [ext/rfmt/src/emitter/mod.rs781](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L781-L781)

---

## Source Extraction Strategy

For complex predicates and conditions that are difficult to reconstruct from AST nodes, the emitter extracts text directly from source. This strategy ensures correctness while maintaining implementation simplicity.

**Control flow elements using source extraction:**

| Element | Method | Line Reference |
| --- | --- | --- |
| If/unless predicates | Extract from predicate node offsets | [ext/rfmt/src/emitter/mod.rs770-778](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L770-L778) |
| Case predicates | Extract from first child offsets | [ext/rfmt/src/emitter/mod.rs565-571](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L565-L571) |
| When conditions | Extract from condition node offsets | [ext/rfmt/src/emitter/mod.rs622-631](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L622-L631) |
| While/until predicates | Extract from predicate node offsets | [ext/rfmt/src/emitter/mod.rs1009-1016](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L1009-L1016) |
| For index and collection | Extract from child node offsets | [ext/rfmt/src/emitter/mod.rs1033-1042](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L1033-L1042) |

This approach handles complex expressions (method calls, operators, nested structures) without requiring custom reconstruction logic for each case.

**Sources:** [ext/rfmt/src/emitter/mod.rs565-778](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L565-L778) [ext/rfmt/src/emitter/mod.rs1009-1042](https://github.com/fs0414/rfmt/blob/90c575e6/ext/rfmt/src/emitter/mod.rs#L1009-L1042)

---

## Testing Coverage

Control flow formatting is extensively tested to ensure correctness across various scenarios:

| Test File | Coverage |
| --- | --- |
| `spec/conditional_formatting_spec.rb` | if/elsif/else, unless/else, postfix modifiers, nested conditionals |
| `spec/case_formatting_spec.rb` | case/when/else, nested case statements |
| `spec/loop_formatting_spec.rb` | while loops, until loops, for loops, break/next keywords |

Test examples validate indentation correctness, keyword alignment, and modifier form preservation [spec/conditional\_formatting\_spec.rb6-107](https://github.com/fs0414/rfmt/blob/90c575e6/spec/conditional_formatting_spec.rb#L6-L107) [spec/case\_formatting\_spec.rb6-22](https://github.com/fs0414/rfmt/blob/90c575e6/spec/case_formatting_spec.rb#L6-L22) [spec/loop\_formatting\_spec.rb6-34](https://github.com/fs0414/rfmt/blob/90c575e6/spec/loop_formatting_spec.rb#L6-L34)

**Sources:** [spec/conditional\_formatting\_spec.rb1-108](https://github.com/fs0414/rfmt/blob/90c575e6/spec/conditional_formatting_spec.rb#L1-L108) [spec/case\_formatting\_spec.rb1-23](https://github.com/fs0414/rfmt/blob/90c575e6/spec/case_formatting_spec.rb#L1-L23) [spec/loop\_formatting\_spec.rb1-35](https://github.com/fs0414/rfmt/blob/90c575e6/spec/loop_formatting_spec.rb#L1-L35)

Dismiss

Refresh this wiki

Enter email to refresh

### On this page

* [Control Flow Formatting](https://deepwiki.com/fs0414/rfmt/5.1-control-flow-formatting.html#control-flow-formatting)
* [Conditional Statement Formatting](https://deepwiki.com/fs0414/rfmt/5.1-control-flow-formatting.html#conditional-statement-formatting)
* [Block If/Unless/Elsif/Else](https://deepwiki.com/fs0414/rfmt/5.1-control-flow-formatting.html#block-ifunlesselsifelse)
* [Postfix Conditionals (Modifier Form)](https://deepwiki.com/fs0414/rfmt/5.1-control-flow-formatting.html#postfix-conditionals-modifier-form)
* [Ternary Operators](https://deepwiki.com/fs0414/rfmt/5.1-control-flow-formatting.html#ternary-operators)
* [Nested Conditionals](https://deepwiki.com/fs0414/rfmt/5.1-control-flow-formatting.html#nested-conditionals)
* [Control Flow Dispatch Architecture](https://deepwiki.com/fs0414/rfmt/5.1-control-flow-formatting.html#control-flow-dispatch-architecture)
* [Case/When Statement Formatting](https://deepwiki.com/fs0414/rfmt/5.1-control-flow-formatting.html#casewhen-statement-formatting)
* [Formatting Rules](https://deepwiki.com/fs0414/rfmt/5.1-control-flow-formatting.html#formatting-rules)
* [Implementation Details](https://deepwiki.com/fs0414/rfmt/5.1-control-flow-formatting.html#implementation-details)
* [Loop Construct Formatting](https://deepwiki.com/fs0414/rfmt/5.1-control-flow-formatting.html#loop-construct-formatting)
* [While/Until Loops](https://deepwiki.com/fs0414/rfmt/5.1-control-flow-formatting.html#whileuntil-loops)
* [For Loops](https://deepwiki.com/fs0414/rfmt/5.1-control-flow-formatting.html#for-loops)
* [Loop Control Keywords](https://deepwiki.com/fs0414/rfmt/5.1-control-flow-formatting.html#loop-control-keywords)
* [Formatting Rules](https://deepwiki.com/fs0414/rfmt/5.1-control-flow-formatting.html#formatting-rules-1)
* [Postfix Form Support](https://deepwiki.com/fs0414/rfmt/5.1-control-flow-formatting.html#postfix-form-support)
* [AST Structure for Control Flow](https://deepwiki.com/fs0414/rfmt/5.1-control-flow-formatting.html#ast-structure-for-control-flow)
* [Child Node Extraction for Control Flow](https://deepwiki.com/fs0414/rfmt/5.1-control-flow-formatting.html#child-node-extraction-for-control-flow)
* [IfNode / UnlessNode Children](https://deepwiki.com/fs0414/rfmt/5.1-control-flow-formatting.html#ifnode-unlessnode-children)
* [CaseNode Children](https://deepwiki.com/fs0414/rfmt/5.1-control-flow-formatting.html#casenode-children)
* [WhileNode / UntilNode Children](https://deepwiki.com/fs0414/rfmt/5.1-control-flow-formatting.html#whilenode-untilnode-children)
* [ForNode Children](https://deepwiki.com/fs0414/rfmt/5.1-control-flow-formatting.html#fornode-children)
* [Indentation Management](https://deepwiki.com/fs0414/rfmt/5.1-control-flow-formatting.html#indentation-management)
* [Comment Preservation in Control Flow](https://deepwiki.com/fs0414/rfmt/5.1-control-flow-formatting.html#comment-preservation-in-control-flow)
* [Source Extraction Strategy](https://deepwiki.com/fs0414/rfmt/5.1-control-flow-formatting.html#source-extraction-strategy)
* [Testing Coverage](https://deepwiki.com/fs0414/rfmt/5.1-control-flow-formatting.html#testing-coverage)
